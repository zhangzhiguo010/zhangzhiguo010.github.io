<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>前后端交互 | 张治国的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="#参考资料：《JS高程》page562页、《JS权威指南》page579页、方应杭视频 #九、Cookie是什么？Session是什么？二者之间有什么联系？ ###1. cookie：   作用： cookie用来记录用户数据，cookie被保存在浏览器本地      使用过程： 用户登录成功以后， 服务器通过Set-Cookie设置cookie，cookie值就是用户信息， 之后浏览器每次访问服">
<meta property="og:type" content="article">
<meta property="og:title" content="前后端交互">
<meta property="og:url" content="http://yoursite.com/2018/11/23/前后端交互/index.html">
<meta property="og:site_name" content="张治国的博客">
<meta property="og:description" content="#参考资料：《JS高程》page562页、《JS权威指南》page579页、方应杭视频 #九、Cookie是什么？Session是什么？二者之间有什么联系？ ###1. cookie：   作用： cookie用来记录用户数据，cookie被保存在浏览器本地      使用过程： 用户登录成功以后， 服务器通过Set-Cookie设置cookie，cookie值就是用户信息， 之后浏览器每次访问服">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-11-23T03:17:30.058Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前后端交互">
<meta name="twitter:description" content="#参考资料：《JS高程》page562页、《JS权威指南》page579页、方应杭视频 #九、Cookie是什么？Session是什么？二者之间有什么联系？ ###1. cookie：   作用： cookie用来记录用户数据，cookie被保存在浏览器本地      使用过程： 用户登录成功以后， 服务器通过Set-Cookie设置cookie，cookie值就是用户信息， 之后浏览器每次访问服">
  
    <link rel="alternate" href="/atom.xml" title="张治国的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">张治国的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-前后端交互" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/23/前后端交互/" class="article-date">
  <time datetime="2018-11-23T02:31:50.000Z" itemprop="datePublished">2018-11-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      前后端交互
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#参考资料：《JS高程》page562页、《JS权威指南》page579页、方应杭视频</p>
<p>#九、Cookie是什么？Session是什么？二者之间有什么联系？</p>
<p>###1. cookie：</p>
<ul>
<li><ol>
<li>作用：<ul>
<li>cookie用来记录用户数据，cookie被保存在浏览器本地</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>使用过程：<ul>
<li>用户登录成功以后，</li>
<li>服务器通过Set-Cookie设置cookie，cookie值就是用户信息，</li>
<li>之后浏览器每次访问服务器，都会带上cookie，读取cookie就得到了用户的信息</li>
</ul>
</li>
</ol>
</li>
<li><ol start="3">
<li>有效期：<ul>
<li>cookie默认是关闭浏览器就消失，但是我们可以在服务器中通过Max-Age设置有效期或者通过Expires设置过期日期。</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>###2. session：</p>
<ul>
<li><ol>
<li>作用：<ul>
<li>session用来记录用户数据，session本质是哈希表，里边是一个个键值对，键名就是随机数sessionId，键值就是用户的信息。</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>使用过程：<ul>
<li>用户通过浏览器登录服务器成功以后，</li>
<li>服务器通过Set-Cookie设置cookie，cookie值就是sessionId</li>
<li>之后浏览器每次访问服务器，都会带上cookie，读取cookie得到sessionId，然后在session哈希表中就得到了用户的信息。</li>
</ul>
</li>
</ol>
</li>
<li><ol start="3">
<li>有效期：<ul>
<li>session被存在服务器的内存中，服务器重新启动就会消失，所以我们重启服务器的时候都要备份一下session。</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>###3. cookie和session有什么联系？</p>
<ul>
<li>session基于cookie实现的，</li>
<li>如果cookie不搭配session使用，那么cookie值就是用户的信息，<br>  该信息被明文暴露在了浏览器上，可以被更改也可以被容易的看到，很不安全，  </li>
<li>如果搭配session使用，那么cookie值就是sessionId这个随机数，<br>  用户信息是session哈希表中sessionId对应的值，该信息保存在服务器中，不会暴露给浏览器，所以安全。</li>
</ul>
<p>#八、LocalStorage 是什么？SessionStorage是什么？二者之间有什么区别？</p>
<p>###1. LocalStorage：</p>
<ul>
<li><ol>
<li>作用：<ul>
<li>LocalStorage是本地存储，存储一些不用考虑安全性的信息，如是否提示过用户，像账号、密码等不能存在这里</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>使用方法：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">localStorage.setItem(<span class="string">'名'</span>, <span class="string">'值'</span>)       	<span class="comment">//存值</span></span><br><span class="line">localStorage.getItem(<span class="string">'名'</span>)             	<span class="comment">//取值</span></span><br><span class="line">localStorage.removeItem(<span class="string">'名'</span>)          	<span class="comment">//删值</span></span><br><span class="line">localStorage.clear( )                 	<span class="comment">//清空</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><ol start="3">
<li>有效期：<ul>
<li>永久有效，除非用户清理缓存</li>
</ul>
</li>
</ol>
</li>
<li><ol start="4">
<li>补充：<ul>
<li>只有相同域名的页面才能互相读取localStorage（没有同源那么严重）</li>
<li>localStorage跟HTTP无关，HTTP不会带上localStorage</li>
<li>每个域名最大存储量大概是10MB，浏览器不同数值不同</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>###2. SessionStorage：</p>
<ul>
<li>大体上和LocalStorage是一样的，只是有效期不一样，</li>
<li>SessionStorage的有效期是页面关闭后失效，而LocalStorage永久有效，除非用户清理缓存</li>
</ul>
<p>###3. indexDB是什么？</p>
<ul>
<li>数据存储用的，cookie最大存4kb，localStorage和sessionStorage最大存10MB，都太小了</li>
<li>储存空间大：不少于250MB</li>
<li>哈希表结构，键值对存储</li>
<li>同源限制，网页只能访问自身域名下的数据库，而不能访问跨域的数据库</li>
</ul>
<p>#七、Cache-Control是什么？ETag是什么？两者之间有什么区别？</p>
<p>###1. Cache-Control：</p>
<ul>
<li>Cache-Control是缓存控制，是服务器设置，它是为了提高web性能而存在的。</li>
<li>在有效期内发起请求，浏览器从本地读取资源，</li>
<li>在有效期外发起请求，浏览器从服务器得到资源，</li>
<li>如果想在有效期内从服务器下载资源，我们修改路径上的查询参数</li>
<li>有效期可以通过Max-Age设置成时间段，也可以通过Expires设置成截止日期</li>
</ul>
<p>###2. ETag：</p>
<ul>
<li>Etag是资源的标识，由服务器设置，浏览器每次请求，服务器都会生成资源的新的Etag值，并且读取    请求报文中的if-none-match中保存的上一次资源的Etag值，将两次的值作比较</li>
<li>比较结果相同，返回304，浏览器就从缓存中读取资源</li>
<li>比较结果不同，就把服务器端的资源放到响应体里交给浏览器</li>
<li>Etag值通常是资源的md5值</li>
</ul>
<p>###3. 有什么不同：</p>
<ul>
<li>Cache-Control在有效期内，不发送http请求，ETag总是会发送http请求。</li>
</ul>
<p>#六、表单加密有什么方式？<br>步骤1：浏览器对传输的数据转成md5值，并且和服务器商量好，在该md5值中混入一些其他数字<br>步骤2：服务器得到数据，去掉混入的数据后得到真正的md5值，将md5值转化成数据即可</p>
<p>#五、GET和POST的区别是什么？</p>
<ul>
<li>1、数据位置：Get的数据放在URL的查询参数里，POST的数据放在请求体里；  </li>
<li>2、大小限制：GET是1024个字符，POST大概是4~10MB左右；  </li>
<li>3、安全性：GET没有POST安全，其实两者都不安全；  </li>
<li>4、缓存：GET可以被缓存，可以被收藏进书签，POST可以被缓存，不能被收藏进书签</li>
<li>5、作用：GET用来读数据，POST用来写数据，POST不幂等<br>（幂等的意思是不管发送多少次请求，结果都一样）</li>
</ul>
<p>#四、同源策略：</p>
<ul>
<li>浏览器必须保证：只有协议+域名+端口号保持一模一样才允许发AJAX请求</li>
<li>判断：AJAX被定义时的IP地址与AJAX中open中定义的IP地址</li>
<li>情景：A服务器上的页面想要访问B服务器，<br>  需要在js文件中ajax的open中写入B服务器地址，<br>  需要在B服务器上设置下面的首都字段：<br>  `<pre><code>response.setHeader(&apos;Access-Control-Allow-Origin&apos;: &apos;http://192.168.0.103:8080&apos;)，  //后面的是A服务器地址
</code></pre>  `</li>
<li>form可以跨域，是因为form方法会刷新页面，导致原页面的脚本无法获取新页面中的内容，<br>  浏览器认为这是安全的。</li>
<li>如果不是百度页面里面的js，就不能向百度这个域名发起AJAX请求，<br>  但是JSONP方式可以，img、form、script、link等等。</li>
</ul>
<p>#三、怎么跨域？</p>
<p>###1. 利用JSONP实现跨域</p>
<p>###2. CORS实现跨域<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在请求首部字段中加入Origin: http:<span class="comment">//www.xx.com:8080</span></span><br><span class="line">   在响应首部字段中加入Access-Control-Allow-Origin: http:<span class="comment">//www.xx.com:8080</span></span><br></pre></td></tr></table></figure></p>
<p>###3. postMessage实现跨域</p>
<p>#二、AJAX和其他方式的比较：</p>
<ul>
<li>用form可以发get或post请求，但是会刷新页面或是新开页面</li>
<li>用a可以发get请求，但是会刷新页面或是新开页面</li>
<li>用img可以发get请求，但是只能以图片的形式展示</li>
<li>用link可以发get请求，但是只能以css的形式展示</li>
<li>用script可以发get请求，但是只能以脚本的形式运行</li>
<li>AJAX能以get、post、delete等等方法发送请求，想以什么形式展示就以什么形式展示</li>
</ul>
<p>#一、JSONP是什么？Ajax是什么？二者之间有什么区别？</p>
<p>###1. JSONP：</p>
<ul>
<li><ol>
<li>作用：<ul>
<li>发送http请求</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>什么是JSONP？<ul>
<li>JSONP是前端向后端请求数据的一种方式，</li>
<li>前端动态创建script和回调函数并发起get请求，</li>
<li>后端构造函数的执行并传入json格式的参数，</li>
<li>前端接收响应并执行回调函数，</li>
<li>至此便得到了想要的后端数据</li>
<li>备注：后端只是构造，并不调用，调用是在前端得到响应的一刹那！</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>使用方法：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">script.src = <span class="string">`/abc?callback<span class="subst">$&#123;<span class="keyword">function</span>(responseData)&#123;alert(responseData)&#125;</span>&#125;`</span> </span><br><span class="line"><span class="built_in">document</span>.body.appendChild(script)</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<p>###2. Ajax：</p>
<ul>
<li><ol>
<li>作用：<ul>
<li>发送http请求，实现了页面的局部刷新</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>使用方法：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/ajax'</span>)                                  </span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="params">()</span>=&gt;</span>&#123;               </span><br><span class="line">    <span class="keyword">if</span>(xhr.readyState===<span class="number">4</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(xhr.status&gt;=<span class="number">200</span> &amp;&amp; xhr.status&lt;<span class="number">300</span>)&#123;........&#125;         </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(xhr.status&gt;=<span class="number">400</span>)&#123;......&#125;                                </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xhr.send()</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>3.补充：</p>
</li>
<li>设置状态行<ul>
<li>不跨域：xhr.open(‘GET’, ‘/ajax’)                       </li>
<li>跨域：xhr.open(‘GET’, ‘<a href="http://zhang.com:8888/ajax&#39;" target="_blank" rel="noopener">http://zhang.com:8888/ajax&#39;</a>) </li>
</ul>
</li>
<li>设置首部字段 <ul>
<li>xhr.setRequestHeader(‘Content-Type’, ‘x-www-form-urlencoded’)</li>
</ul>
</li>
<li><p>设置请求主体 </p>
<ul>
<li>xhr.send(‘a=1&amp;b=2’)                                         </li>
<li>GET时浏览器认为不发送数据，故不显示</li>
</ul>
</li>
<li><p>获得状态行</p>
<ul>
<li>状态码：xhr.status        </li>
<li>解释信息：xhr.statusText                                                    </li>
<li>获得所有首部字段：xhr.getAllResponsHeaders()                  </li>
<li>获得单个首部字段：xhr.getResponseHeader(‘Content-Type’)                </li>
</ul>
</li>
<li>获得响应主体 <ul>
<li>xhr.responseText                                                     </li>
<li>数据转化                                         <ul>
<li>将符合JSON的字符串转化成相对应的JavaScript值<br><code>window.JSON.parse(xhr.responseText)</code></li>
</ul>
</li>
<li>返回响应第一部分时浏览器就知道了状态码，但是我们等响应主体全部被浏览器下载完后，readystate变为4以后再去判断statue，然后操作响应主体</li>
</ul>
</li>
</ul>
<p>###3. 两者之间有什么区别？</p>
<ul>
<li>都是前端向后端请求数据的技术，也都实现了局部刷新，也都对数据类型没有限制</li>
<li>JSON是动态创建<script>标签，AJAX是创建XMLHttpRquest对象</li>
<li>JSONP只能GET，AJAX能GET能POST</li>
<li>JSONP能跨域请求数据，AJAX不能，服务器端CORS(跨站资源共享)技术可以解决跨域问题</li>
</ul>
</script></li></ul>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/23/前后端交互/" data-id="cjothuzss000tm8qrhc5ruzbl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/11/23/网络安全/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          网络安全
        
      </div>
    </a>
  
  
    <a href="/2018/11/23/HTTP-基础/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">HTTP-基础</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/11/23/数据结构和算法/">数据结构和算法</a>
          </li>
        
          <li>
            <a href="/2018/11/23/JS-Canvas/">JS-Canvas</a>
          </li>
        
          <li>
            <a href="/2018/11/23/网络安全/">网络安全</a>
          </li>
        
          <li>
            <a href="/2018/11/23/前后端交互/">前后端交互</a>
          </li>
        
          <li>
            <a href="/2018/11/23/HTTP-基础/">HTTP-基础</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 张治国<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>